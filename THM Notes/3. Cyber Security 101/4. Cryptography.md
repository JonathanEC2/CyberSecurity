
# Cryptography Basics

## Importance of Cryptography 

Cryptography can be defined as the practice and study of techniques for secure communication and data protection where we expect the presence of adversaries and third parties

## Plaintext to Ciphertext 

Plaintext is readable data. Plaintext is passed through the encryption function along with the proper key; returns a ciphertext. The encryption function is part of the cipher. A <mark style="background: #FFF3A3A6;">cipher</mark> is an algorithm to convert a plaintext into a ciphertext and vice versa.

To recover the plaintext, we must pass the ciphertext along with the proper key via the decryption function

## Types of Encryption

#### Symmetric encryption

uses the same key to encrypt and decrypt data. Called private key cryptography. Requires a secure communication channel.

#### Asymmetric encryption

 uses key pairs; called public key cryptography. Tends to be slower than symmetric.

## Basic Math

#### XOR operation 

exclusive or; compares two bits and returns 1 if the bits are different and 0 if they are the same. This is often represented by the ⊕ symbol

XOR has many properties that make it useful in cryptography and error detection. One property is that applying XOR to a value within itself results in 0 and applying XOR to any value with 0 leaves it unchanged. This means A ⊕ A = 0, and A ⊕ 0 = A for any binary value A. Additionally, XOR is **commutative**, i.e., A ⊕ B = B ⊕ A. And it is **associative**, i.e., (A ⊕ B) ⊕ C = A ⊕ (B ⊕ C).

#### Modulo Operation

the modulo operator, X%Y, is the remainder when X is divided by Y.

<span style="color:rgb(255, 0, 0)">Modulo is not reversible.</span> If we are given the equation _x_%5 = 4, infinite values of _x_ would satisfy this equation.

Always returns a non-negative number less than the divisor.

# Public Key Cryptography Basics

Ensures authentication, authenticity, and integrity

## Common Use of Asymmetric Encryption

We use asymmetric encryption to negotiate and agree on symmetric encryption ciphers and keys

Equivalent to sending a box with a lock (Public Key) to your friend that has its key (Private Key) that contains a secret code (symmetric encryption ciphers and keys)

## RSA

A public key encryption algorithm that enables secure data transmission over insecure channels. 

#### The Math That Makes RSA Secure

RSA is based on factoring a large number. It is tricky to determine what two prime numbers make very large numbers (more than 600 digits). 

#### RSA in CTFs

The math behind RSA comes up pretty often in CTFs, requiring you to calculate variables to break some encryption based on them. Some tools for defeating RSA challenges in CTFs:
 - [RsaCtfTool](https://github.com/Ganapati/RsaCtfTool)
  - [rsatool](https://github.com/ius/rsatool).

The main variables for RSA in CTFs: p, q, m, n, e, d, and c. As per our numerical example:

- p and q are large prime numbers
- n is the product of p and q
- The public key is n and e
- The private key is n and d
- m is used to represent the original message, i.e., plaintext
- c represents the encrypted text, i.e., ciphertext

$n = p * q$
$ϕn = n - p - q +1$
$e$ is a relative prime to $ϕn$
	relative prime means no other integer can divide between both numbers
$e * d$ 1 mod $ϕn$
public key is (n, e)
private key is (n, d)
Value you want to encrypt is x
$y = x^e$ mod n
$x = y^d$ mod n